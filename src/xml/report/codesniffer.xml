<?xml version="1.0" encoding="UTF-8"?>

<!-- ============================================================  -->
<!-- report.codesniffer                                            --> 
<!--                                                               --> 
<!-- @author Jan Thoennessen <jan.thoennessen@googlemail.com>      --> 
<!-- ============================================================  -->
<project name="report.codesniffer">


    <!-- ============================================  -->
    <!-- report.codesniffer:init                       --> 
    <!-- ============================================  -->  
    <target name="report.codesniffer:init">
        <echo message="report.codesniffer:init default" />
        
        <patternset id="patternset.report.codesniffer">
            <include name="**/*.php"     />
            <exclude name="build/**"     />
            <exclude name="public/**"    />
            <exclude name="resources/**" />
            <exclude name="vendor/**"    />
        </patternset>        
    </target>
    
    
    <!-- ============================================  -->
    <!-- report.codesniffer:before                     -->
    <!-- ============================================  -->
    <target name="report.codesniffer:before">
        <echo message="report.codesniffer:before default" />
    </target>
        
        
    <!-- ============================================  -->
    <!-- report.codesniffer:main                       --> 
    <!-- ============================================  -->  
    <target name="report.codesniffer:main">
        <delete dir="${project.reports}/codesniffer" />
        <mkdir  dir="${project.reports}/codesniffer" />
        
        <delete dir="${project.reports}/codesniffer-overview" />
        <mkdir  dir="${project.reports}/codesniffer-overview" />
        
        <phpcodesniffer standard="Zend" showSniffs="true" showWarnings="true" docGenerator="HTML" docFile="${project.reports}/codesniffer-overview/index.html">
            <fileset dir=".">
                <patternset refid="patternset.report.codesniffer" />
            </fileset>
            
            <formatter type="checkstyle" outfile="${project.reports}/codesniffer/checkstyle.codesniffer.xml" />
        </phpcodesniffer>
        
        <xslt file="${project.reports}/codesniffer/checkstyle.codesniffer.xml" tofile="${project.reports}/codesniffer/index.html" style="${phing:commons:xsl}/checkstyle.codesniffer.xsl" />
    </target>
    
    
    <!-- ============================================  -->
    <!-- report.codesniffer:after                      -->
    <!-- ============================================  -->
    <target name="report.codesniffer:after">
        <echo message="report.codesniffer:after default" />
    </target>
    
    
    <!-- ============================================  -->
    <!-- report.codesniffer                            -->
    <!-- ============================================  -->
    <target name="report.codesniffer" depends="report.codesniffer:init,report.codesniffer:before,report.codesniffer:main,report.codesniffer:after" />
 
 
</project>