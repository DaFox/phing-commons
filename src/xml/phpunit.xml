<?xml version="1.0" encoding="UTF-8"?>

<project name="reports" basedir=".">
	
	
	
    <!-- ============================================  -->
    <!-- phpunit                                       --> 
    <!-- ============================================  -->  
    <target name="phpunit" depends="phplint">
		<echo msg="run phpunit" />
		
        <mkdir dir="${path.reports}/phpunit" />
        <mkdir dir="${path.reports}/phpunit-coverage-report" />

        <phpunit bootstrap="tests/bootstrap.php" codecoverage="false" haltonfailure="true" haltonerror="true">
            <formatter todir="${path.reports}/phpunit" type="xml" />
			
            <batchtest>
                <fileset dir="tests">
                    <include name="**/*Test*.php" />
                </fileset>
            </batchtest>
        </phpunit>
        
        <phpunitreport infile="${path.reports}/phpunit/testsuites.xml" format="frames" todir="${path.reports}/phpunit" />
		
        <exec command="phpunit --coverage-html ${path.reports}/phpunit-coverage-report --bootstrap tests/bootstrap.php tests" />
    
        <echo msg="end phpunit" />
    </target>

	
	
	   	
</project>